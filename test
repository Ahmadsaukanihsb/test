local Players = game:GetService("Players")
local player = Players.LocalPlayer
local gui = player:WaitForChild("PlayerGui")

-- GUI Utama
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "KyroscScriptsGUI"
screenGui.Parent = gui
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 300, 0, 320)  -- diperbesar untuk hasil pencarian
mainFrame.Position = UDim2.new(0.5, -150, 0.5, -160)
mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 8)
corner.Parent = mainFrame

-- Tombol toggle GUI (sembunyi/tampil)
local toggleButton = Instance.new("TextButton")
toggleButton.Name = "ToggleButton"
toggleButton.Size = UDim2.new(0, 40, 0, 40)
toggleButton.Position = UDim2.new(0.5, 170, 0.5, -160)  -- di kanan mainFrame
toggleButton.AnchorPoint = Vector2.new(0, 0)
toggleButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
toggleButton.BorderSizePixel = 0
toggleButton.Text = "☰"
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.Font = Enum.Font.GothamBold
toggleButton.TextSize = 24
toggleButton.Parent = screenGui

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0, 6)
toggleCorner.Parent = toggleButton

-- Judul (tempat drag)
local title = Instance.new("TextLabel")
title.Name = "Title"
title.Text = "KyroscScripts (v3.2.1)"
title.Size = UDim2.new(1, 0, 0, 30)
title.Position = UDim2.new(0, 0, 0, 10)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 16
title.Parent = mainFrame

-- Instruksi Pet
local petInstructions = Instance.new("TextLabel")
petInstructions.Name = "PetInstructions"
petInstructions.Text = "Hold one of these pets:\n- Red Fox - Dragonfly\n- Raccoon - Praying Mantis\n- Deer\nThen click to start."
petInstructions.Size = UDim2.new(0.9, 0, 0, 80)
petInstructions.Position = UDim2.new(0.05, 0, 0, 40)
petInstructions.BackgroundTransparency = 1
petInstructions.TextColor3 = Color3.fromRGB(200, 200, 200)
petInstructions.Font = Enum.Font.Gotham
petInstructions.TextSize = 13
petInstructions.TextXAlignment = Enum.TextXAlignment.Left
petInstructions.TextYAlignment = Enum.TextYAlignment.Top
petInstructions.Parent = mainFrame

-- Frame hasil pencarian
local resultsFrame = Instance.new("ScrollingFrame")
resultsFrame.Name = "ResultsFrame"
resultsFrame.Size = UDim2.new(0.9, 0, 0, 100)
resultsFrame.Position = UDim2.new(0.05, 0, 0, 125)
resultsFrame.BackgroundTransparency = 1
resultsFrame.BorderSizePixel = 0
resultsFrame.ScrollBarThickness = 5
resultsFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
resultsFrame.Parent = mainFrame

local resultsLayout = Instance.new("UIListLayout")
resultsLayout.Padding = UDim.new(0, 5)
resultsLayout.Parent = resultsFrame

-- Tombol Start
local startButton = Instance.new("TextButton")
startButton.Name = "StartButton"
startButton.Text = "Start Execution"
startButton.Size = UDim2.new(0.9, 0, 0, 40)
startButton.Position = UDim2.new(0.05, 0, 0, 230)
startButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
startButton.BorderSizePixel = 0
startButton.TextColor3 = Color3.fromRGB(255, 255, 255)
startButton.Font = Enum.Font.GothamBold
startButton.TextSize = 14
startButton.Parent = mainFrame

local buttonCorner = Instance.new("UICorner")
buttonCorner.CornerRadius = UDim.new(0, 6)
buttonCorner.Parent = startButton

-- Footer
local footer = Instance.new("TextLabel")
footer.Name = "Footer"
footer.Text = "KyroscScripts | discord.gg/SqqvAH7nXf"
footer.Size = UDim2.new(1, 0, 0, 20)
footer.Position = UDim2.new(0, 0, 1, -20)
footer.BackgroundTransparency = 1
footer.TextColor3 = Color3.fromRGB(150, 150, 150)
footer.Font = Enum.Font.Gotham
footer.TextSize = 12
footer.Parent = mainFrame

-- Notifikasi
local function showNotification(message, color)
    local notification = Instance.new("TextLabel")
    notification.Name = "Notification"
    notification.Text = message
    notification.Size = UDim2.new(0.8, 0, 0, 40)
    notification.Position = UDim2.new(0.5, 0, 0, -50)
    notification.AnchorPoint = Vector2.new(0.5, 0)
    notification.BackgroundColor3 = color
    notification.TextColor3 = Color3.fromRGB(255, 255, 255)
    notification.Font = Enum.Font.GothamBold
    notification.TextSize = 14
    notification.Parent = mainFrame

    local notifCorner = Instance.new("UICorner")
    notifCorner.CornerRadius = UDim.new(0, 6)
    notifCorner.Parent = notification

    delay(3, function()
        notification:Destroy()
    end)
end

-- Fungsi rekursif pencarian item "Deer"
local function deepFindDeer(parent, path)
    local results = {}
    
    for _, child in ipairs(parent:GetChildren()) do
        if child:IsA("Tool") and child.Name:lower():find("deer") then
            table.insert(results, {
                object = child,
                path = path..child.Name
            })
        end

        if child:IsA("Folder") or child:IsA("Model") then
            local subResults = deepFindDeer(child, path..child.Name.." > ")
            for _, res in ipairs(subResults) do
                table.insert(results, res)
            end
        end
    end
    
    return results
end

-- Fungsi bersihkan hasil pencarian
local function clearResults()
    for _, child in ipairs(resultsFrame:GetChildren()) do
        if not child:IsA("UIListLayout") then
            child:Destroy()
        end
    end
end

-- Fungsi tampilkan hasil pencarian
local function displayResults(results)
    clearResults()
    if #results == 0 then
        local noResult = Instance.new("TextLabel")
        noResult.Name = "NoResult"
        noResult.Text = "No Deer found anywhere"
        noResult.Size = UDim2.new(1, 0, 0, 20)
        noResult.BackgroundTransparency = 1
        noResult.TextColor3 = Color3.fromRGB(255, 50, 50)
        noResult.Font = Enum.Font.Gotham
        noResult.TextSize = 14
        noResult.Parent = resultsFrame
        return
    end

    for _, result in ipairs(results) do
        local label = Instance.new("TextLabel")
        label.Name = "ResultLabel"
        label.Text = result.path .. " (Type: "..result.object.ClassName..")"
        label.Size = UDim2.new(1, 0, 0, 20)
        label.BackgroundTransparency = 1
        label.TextColor3 = Color3.fromRGB(200, 200, 200)
        label.Font = Enum.Font.Gotham
        label.TextSize = 13
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.Parent = resultsFrame
    end
end

-- Lokasi penting untuk pencarian
local importantLocations = {
    game:GetService("Workspace"),
    game:GetService("ReplicatedStorage"),
    game:GetService("ServerStorage"),
    game:GetService("StarterPack"),
    game:GetService("StarterGui"),
    player.Character or player:WaitForChild("Character"),
    player:FindFirstChild("Backpack") or player:WaitForChild("Backpack")
}

-- Fungsi pencarian utama
local function deepSearch()
    startButton.Text = "Searching..."
    startButton.BackgroundColor3 = Color3.fromRGB(255, 165, 0)

    local allResults = {}

    for _, location in ipairs(importantLocations) do
        if location then
            local results = deepFindDeer(location, location.Name .. " > ")
            for _, res in ipairs(results) do
                table.insert(allResults, res)
            end
        end
    end

    displayResults(allResults)
    startButton.Text = "Search Complete"
    startButton.BackgroundColor3 = #allResults > 0 and Color3.fromRGB(0, 150, 0) or Color3.fromRGB(150, 0, 0)

    wait(2)
    startButton.Text = "Start Execution"
    startButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
end

-- Fungsi cek apakah player memegang pet bernama "Deer"
local function isHoldingDeer()
    local character = player.Character or player.CharacterAdded:Wait()

    for _, item in ipairs(character:GetChildren()) do
        if string.lower(item.Name) == "deer" then
            return true
        end
    end

    local backpack = player:FindFirstChild("Backpack")
    if backpack then
        for _, tool in ipairs(backpack:GetChildren()) do
            if string.lower(tool.Name) == "deer" then
                return true
            end
        end
    end

    return false
end

-- Start button klik event
startButton.MouseButton1Click:Connect(function()
    -- Periksa pet
    local validPets = {
        ["red fox"] = true,
        ["dragonfly"] = true,
        ["raccoon"] = true,
        ["praying mantis"] = true,
        ["deer"] = true,
    }

    local holdingValidPet = false
    local character = player.Character or player.CharacterAdded:Wait()
    
    -- Check if player holds any valid pet
    for _, child in ipairs(character:GetChildren()) do
        if child:IsA("Tool") and validPets[string.lower(child.Name)] then
            holdingValidPet = true
            break
        end
    end

    if not holdingValidPet then
        local backpack = player:FindFirstChild("Backpack")
        if backpack then
            for _, tool in ipairs(backpack:GetChildren()) do
                if tool:IsA("Tool") and validPets[string.lower(tool.Name)] then
                    holdingValidPet = true
                    break
                end
            end
        end
    end

    if not holdingValidPet then
        showNotification("You must hold one of these pets first!\nRed Fox, Dragonfly, Raccoon, Praying Mantis, Deer", Color3.fromRGB(255, 50, 50))
        return
    end

    deepSearch()
end)

-- Fitur drag GUI (drag dari title)
local dragging = false
local dragInput, dragStart, startPos

title.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position

        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

title.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(
            math.clamp(startPos.X.Scale, 0, 1),
            math.clamp(startPos.X.Offset + delta.X, 0, workspace.CurrentCamera.ViewportSize.X - mainFrame.AbsoluteSize.X),
            math.clamp(startPos.Y.Scale, 0, 1),
            math.clamp(startPos.Y.Offset + delta.Y, 0, workspace.CurrentCamera.ViewportSize.Y - mainFrame.AbsoluteSize.Y)
        )
        toggleButton.Position = UDim2.new(mainFrame.Position.X.Scale, mainFrame.Position.X.Offset + mainFrame.AbsoluteSize.X + 10, mainFrame.Position.Y.Scale, mainFrame.Position.Y.Offset)
    end
end)

-- Tombol toggle GUI
local guiVisible = true
toggleButton.MouseButton1Click:Connect(function()
    guiVisible = not guiVisible
    mainFrame.Visible = guiVisible
    if guiVisible then
        toggleButton.Text = "☰"
    else
        toggleButton.Text = "❌"
    end
end)
